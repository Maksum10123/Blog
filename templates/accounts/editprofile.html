{% extends "base/base.html" %}
{% load static %}

{% block content %}

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8 col-xl-7">

            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <div class="edit-profile-card">

                    <div class="profile-cover"></div>

                    <div class="card-body text-center p-4">

                        <div class="avatar-edit-container">
                            {% if profile.avatar %}
                                <img src="{{ profile.avatar.url }}" alt="avatar" class="profile-avatar-preview" id="avatar-preview">
                            {% else %}
                                <img src="https://static.vecteezy.com/system/resources/previews/009/292/244/non_2x/default-avatar-icon-of-social-media-user-vector.jpg" alt="avatar" class="profile-avatar-preview" id="avatar-preview">
                            {% endif %}

                            <label for="avatar-input" class="avatar-upload-icon" title="Изменить фото">
                                <i class="fa-solid fa-camera"></i>
                            </label>
                            <input type="file" id="avatar-input" name="avatar" accept="image/*" onchange="previewImage(event)">
                        </div>

                        <h3 class="mb-4 text-secondary">Редактирование профиля</h3>

                        <div class="form-group-custom">
                            <label for="username" class="form-label-custom">Никнейм</label>
                            <input type="text" name="username" id="username" class="form-control-custom" value="{{ profile.username }}" required>
                        </div>

                        <div class="form-group-custom">
                            <label for="bio" class="form-label-custom">О себе (Bio)</label>
                            <textarea name="bio" id="bio" class="form-control-custom" placeholder="Расскажите немного о себе...">{{ profile.bio }}</textarea>
                        </div>

                        <hr class="my-4" style="opacity: 0.1">

                        <div class="d-flex justify-content-center align-items-center">
                            <button type="submit" class="btn-save">
                                <i class="fa-regular fa-floppy-disk me-2"></i>Сохранить
                            </button>

                            <a href="{% url 'profile' user.id %}" class="btn-cancel">Отмена</a>
                        </div>

                    </div>
                </div>
            </form>

        </div>
    </div>
</div>

<script>
    function previewImage(event) {
        var reader = new FileReader();
        reader.onload = function(){
            var output = document.getElementById('avatar-preview');
            output.src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }
</script>

{% endblock %}